generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

model User {
  id        String   @id @default(uuid())
  username  String   @unique
  password  String
  createdAt DateTime @default(now())

  @@map("users")
}

model Station {
  id             String         @id @default(uuid())
  name           String         @unique
  routeStations  RouteStation[]

  @@map("stations")
}

model Train {
  id        String     @id @default(uuid())
  name      String
  capacity  Int
  schedules Schedule[]

  @@map("trains")
}

model Route {
  id            String         @id @default(uuid())
  name          String
  routeStations RouteStation[]
  schedules     Schedule[]

  @@map("routes")
}

model RouteStation {
  id            String   @id @default(uuid())
  routeId       String
  stationId     String
  order         Int
  arrivalTime   String 
  departureTime String  

  route   Route   @relation(fields: [routeId], references: [id], onDelete: Cascade)
  station Station @relation(fields: [stationId], references: [id])

  @@unique([routeId, order])
  @@map("route_stations")
}

model Schedule {
  id            String   @id @default(uuid())
  trainId       String
  routeId       String
  departureTime DateTime
  daysOfWeek    Int[]    @default([1, 2, 3, 4, 5, 6, 0]) 

  train Train @relation(fields: [trainId], references: [id], onDelete: Cascade)
  route Route @relation(fields: [routeId], references: [id], onDelete: Cascade)

  @@map("schedules")
}